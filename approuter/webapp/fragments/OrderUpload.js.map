{"version":3,"file":"OrderUpload.js","names":["sap","ui","define","BaseController","ODataModel","MessageToast","MessageBox","Filter","FilterOperator","Table","Column","ColumnListItem","Text","JSONModel","extend","onInit","this","_localModel","getOwnerComponent","getModel","oRouter","getRouter","getRoute","attachPatternMatched","_onObjectMatched","formatDateToISO","dateStr","date","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds","onBeforeRendering","detachPatternMatched","onAfterRendering","sFragmentName","sControllerName","oFragment","getView","oController","getController","loadFragment","onFileChange","oEvent","aFiles","getParameter","oButton","byId","length","_file","show","onUploadPress","sFragmentIdC","_sFragmentUniqueId","oClearTableContainer","destroyItems","oClearLinkContainer","reader","FileReader","that","onload","e","data","Uint8Array","target","result","workbook","XLSX","read","type","firstSheetName","SheetNames","worksheet","Sheets","jsonData","utils","sheet_to_json","header","uploadType","_validateHeaders","error","_sendDataToOData","_resetFileUploader","readAsArrayBuffer","headers","orderUploadHeaders","grnUploadHeaders","stockUploadHeaders","_compareHeaders","oFileUploader","setValue","uploadedHeaders","expectedHeaders","uploadedSet","Set","map","trim","toLowerCase","every","expected","has","async","console","log","oModel","json","useBatch","fieldNames","aPayload","row","oRowData","forEach","fieldName","index","undefined","parseInt","replace","slice","jsonString","JSON","stringify","encoded","btoa","encodeURIComponent","oEntry","vEntry","divisionData","parse","localStorage","getItem","selectedDivision","selectedSflTile","selectedTplTile","bukrs","spart","sUserInfo","oUserInfo","sEmail","email","Key","Value","Bukrs","Spart","Upload","Email","validateUploadedData","m","create","method","success","oError","onDownloadTemplate","core","BusyIndicator","templateUrl","$","ajax","url","contentType","xhrFields","responseType","hide","blob","Blob","downloadUrl","window","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","oErr","errorMessage","responseJSON","innererror","errordetails","message","vModel","Promise","resolve","reject","oData","response","errorRecords","errors","decodedString","decodeURIComponent","atob","parsedErrors","sFragmentId","oLink","oErrorLink","Link","text","press","onErrorDownload","bind","setTooltip","addStyleClass","addItem","oTable","columns","Object","keys","key","oErrorModel","model","oTemplate","cells","setModel","bindItems","oErrorTableContainer","err","complete"],"sources":["OrderUpload-dbg.js"],"mappings":"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","ignoreList":[]}