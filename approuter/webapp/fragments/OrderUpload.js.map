{"version":3,"file":"OrderUpload.js","names":["sap","ui","define","BaseController","ODataModel","MessageToast","MessageBox","Filter","FilterOperator","Table","Column","ColumnListItem","Text","JSONModel","extend","onInit","this","_localModel","getOwnerComponent","getModel","oRouter","getRouter","getRoute","attachPatternMatched","_onObjectMatched","formatDateToISO","dateStr","date","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds","onBeforeRendering","detachPatternMatched","onAfterRendering","sFragmentName","sControllerName","oFragment","getView","oController","getController","loadFragment","onFileChange","oEvent","aFiles","getParameter","oButton","byId","length","_file","show","onUploadPress","sFragmentIdC","_sFragmentUniqueId","oClearTableContainer","destroyItems","oClearLinkContainer","reader","FileReader","fileExt","name","split","pop","toLowerCase","that","sFileType","type","onload","e","data","target","result","workbook","binary","bytes","Uint8Array","i","byteLength","fromCharCode","XLSX","read","m","firstSheet","Sheets","SheetNames","jsonData","utils","sheet_to_json","header","console","log","uploadType","_validateHeaders","error","_sendDataToOData","_resetFileUploader","message","readAsArrayBuffer","headers","orderUploadHeaders","grnUploadHeaders","stockUploadHeaders","_compareHeaders","oFileUploader","setValue","uploadedHeaders","expectedHeaders","uploadedSet","Set","map","trim","every","expected","has","async","oModel","json","useBatch","fieldNames","aPayload","row","oRowData","forEach","fieldName","index","undefined","parseInt","replace","slice","jsonString","JSON","stringify","encoded","btoa","encodeURIComponent","oEntry","vEntry","oPayload","getProperty","divisionData","parse","localStorage","getItem","selectedDivision","selectedSflTile","selectedTplTile","bukrs","spart","sUserInfo","oUserInfo","sEmail","email","Key","Value","Bukrs","Spart","Upload","Email","validateUploadedData","_saveOrderUpload","core","BusyIndicator","$","ajax","url","contentType","success","oData","hide","bind","oErr","statusCode","status","statusText","responseText","onDownloadTemplate","templateUrl","method","xhrFields","responseType","blob","Blob","downloadUrl","window","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","errorMessage","responseJSON","innererror","errordetails","vModel","Promise","resolve","reject","create","response","errorRecords","errors","decodedString","decodeURIComponent","atob","parsedErrors","sFragmentId","oLink","oErrorLink","Link","text","press","onErrorDownload","setTooltip","addStyleClass","addItem","oTable","columns","Object","keys","key","oErrorModel","model","oTemplate","cells","setModel","bindItems","oErrorTableContainer","oError","err","complete"],"sources":["OrderUpload-dbg.js"],"mappings":"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","ignoreList":[]}