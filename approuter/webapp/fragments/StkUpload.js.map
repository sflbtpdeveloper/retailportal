{"version":3,"file":"StkUpload.js","names":["sap","ui","define","BaseController","ODataModel","MessageToast","MessageBox","extend","onInit","this","oRouter","getOwnerComponent","getRouter","getRoute","attachPatternMatched","_onObjectMatched","onBeforeRendering","detachPatternMatched","onAfterRendering","sFragmentName","sControllerName","oFragment","getView","oController","getController","loadFragment","formatDateToISO","dateStr","date","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds","onFileChange","oEvent","aFiles","getParameter","length","_file","show","onRemoveFile","oFileUploader","byId","clear","setVisible","onUploadPress","sFragmentIdC","_sFragmentUniqueId","oClearTableContainer","destroyItems","oClearLinkContainer","reader","FileReader","that","onload","e","data","Uint8Array","target","result","workbook","XLSX","read","type","firstSheetName","SheetNames","worksheet","Sheets","jsonData","utils","sheet_to_json","header","uploadType","_validateHeaders","error","_sendDataToOData","_resetFileUploader","readAsArrayBuffer","headers","orderUploadHeaders","grnUploadHeaders","stockUploadHeaders","_compareHeaders","uploadedHeaders","expectedHeaders","uploadedSet","Set","map","trim","toLowerCase","every","expected","has","setValue","async","oModel","json","useBatch","fieldNames","aPayload","row","oRowData","forEach","fieldName","index","parseInt","replace","slice","jsonString","JSON","stringify","encoded","btoa","encodeURIComponent","oEntry","vEntry","divisionData","parse","localStorage","getItem","selectedDivision","selectedSflTile","selectedTplTile","bukrs","spart","sUserInfo","oUserInfo","sEmail","email","Key","Value","Bukrs","Spart","Upload","Email","validateUploadedData","console","m","create","method","success","oError","onDownloadTemplate","core","BusyIndicator","templateUrl","$","ajax","url","contentType","xhrFields","responseType","hide","blob","Blob","downloadUrl","window","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","oErr","errorMessage","responseJSON","innererror","errordetails","message","vModel","Promise","resolve","reject","oData","response","errorRecords","errors","decodedString","decodeURIComponent","atob","parsedErrors","sFragmentId","oLink","oErrorLink","Link","text","press","onErrorDownload","bind","setTooltip","addStyleClass","addItem","oTable","Table","columns","Object","keys","key","Column","Text","oErrorModel","model","JSONModel","oTemplate","ColumnListItem","cells","setModel","bindItems","oErrorTableContainer","err","complete"],"sources":["StkUpload-dbg.js"],"mappings":"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","ignoreList":[]}