{"version":3,"file":"GrnUpload.js","names":["sap","ui","define","Controller","ODataModel","MessageToast","MessageBox","extend","onInit","this","_localModel","getOwnerComponent","getModel","oRouter","getRouter","getRoute","attachPatternMatched","_onObjectMatched","onBeforeRendering","detachPatternMatched","onAfterRendering","sFragmentName","sControllerName","oFragment","getView","oController","getController","loadFragment","formatDateToISO","dateStr","date","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds","onFileChange","oEvent","aFiles","getParameter","length","_file","show","onUploadPress","sFragmentIdC","_sFragmentUniqueId","oClearTableContainer","byId","destroyItems","oClearLinkContainer","reader","FileReader","that","onload","e","data","Uint8Array","target","result","workbook","XLSX","read","type","firstSheetName","SheetNames","worksheet","Sheets","jsonData","utils","sheet_to_json","header","uploadType","_validateHeaders","error","_sendDataToOData","_resetFileUploader","readAsArrayBuffer","headers","orderUploadHeaders","grnUploadHeaders","stockUploadHeaders","_compareHeaders","uploadedHeaders","expectedHeaders","uploadedSet","Set","map","trim","toLowerCase","every","expected","has","oFileUploader","setValue","async","oModel","json","useBatch","fieldNames","aPayload","row","oRowData","forEach","fieldName","index","undefined","slice","jsonString","JSON","stringify","encoded","btoa","encodeURIComponent","oEntry","vEntry","divisionData","parse","localStorage","getItem","selectedDivision","selectedSflTile","selectedTplTile","bukrs","spart","sUserInfo","oUserInfo","sEmail","email","Key","Value","Bukrs","Spart","Upload","Email","validateUploadedData","console","m","create","method","success","oError","vModel","Promise","resolve","reject","oData","response","errorRecords","errors","decodedString","decodeURIComponent","atob","parsedErrors","sFragmentId","oLink","oErrorLink","Link","text","press","onErrorDownload","bind","setTooltip","addStyleClass","addItem","oTable","Table","columns","Object","keys","key","Column","Text","oErrorModel","model","JSONModel","oTemplate","ColumnListItem","cells","setModel","bindItems","oErrorTableContainer","core","BusyIndicator","$","ajax","url","contentType","xhrFields","responseType","blob","Blob","downloadUrl","window","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","err","complete","hide","oErr","onDownloadTemplate","templateUrl","errorMessage","responseJSON","innererror","errordetails","message"],"sources":["GrnUpload-dbg.js"],"mappings":"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","ignoreList":[]}